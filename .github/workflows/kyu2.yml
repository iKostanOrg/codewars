---
name: Workflow Pipeline for kyu2

on:   # yamllint disable-line rule:truthy
  push:
    branches:
      - kyu2

permissions:
  contents: read
  pull-requests: read

jobs:
  pylint:
    name: Py Lint
    uses: iKostanOrg/codewars/.github/kyu_2/pylint_kyu2.yml@kyu2
  mypy:
    name: MyPy Lint
    uses: iKostanOrg/codewars/.github/kyu_2/mypy_kyu2.yml@kyu2
  flake8:
    name: Flake8 Lint
    uses: iKostanOrg/codewars/.github/kyu_2/flake8_kyu2.yml@kyu2
  yamllint:
    name: YAML Lint
    uses: iKostanOrg/codewars/.github/kyu_2/yamllint_kyu2.yml@kyu2
  pydocstyle:
    name: PyDocStyle Lint
    uses: iKostanOrg/codewars/.github/kyu_2/pydocstyle_kyu2.yml@kyu2
  pytype_kyu2:
    name: PyType Lint (kyu2)
    needs:
      - flake8
      - pylint
      - mypy
      - yamllint
      - pydocstyle
    uses: iKostanOrg/codewars/.github/kyu_2/pytype_kyu2.yml@kyu2
  pytest:
    name: Unitest with pytest
    needs:
      - pytype_kyu2
    uses: iKostanOrg/codewars/.github/kyu_2/pytest_kyu2.yml@kyu2
  codacy:
    name: Codacy Coverage GitHub Action
    needs:
      - pytest
    uses: iKostanOrg/codewars/.github/workflows/codacy-coverage-reporter.yaml@kyu2
    secrets:
      codacy_api_token: ${{ secrets.CODACY_API_TOKEN }}
  codecov:
    name: Codecov Coverage GitHub Action
    needs:
      - pytest
    uses: iKostanOrg/codewars/.github/workflows/codecov.yml@kyu2
    # Why is Codecov upload step in GitHub Actions not finding the token?
    # https://stackoverflow.com/questions/78298827/why-is-codecov-upload-step-in-github-actions-not-finding-the-token
    secrets:
      codecov_token: ${{ secrets.CODECOV_TOKEN }}
  codeclimate_qlty:
    name: QLTY Coverage Github Action
    needs:
      - pytest
    uses: iKostanOrg/codewars/.github/workflows/codeclimate_qlty_coverage.yml@kyu2
    secrets:
      qlty_coverage_token: ${{ secrets.QLTY_COVERAGE_TOKEN }}
  codeclimate:
    name: CodeClimate Coverage Github Action
    needs:
      - pytest
    uses: iKostanOrg/codewars/.github/workflows/codeclimate_coverage.yml@kyu2
    secrets:
      cc_test_reporter_id: ${{ secrets.CC_TEST_REPORTER_ID }}
